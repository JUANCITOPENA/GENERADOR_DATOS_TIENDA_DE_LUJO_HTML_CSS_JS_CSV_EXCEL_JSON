<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <link rel="shortcut icon" href="https://avatars.githubusercontent.com/u/38921558?v=4" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Generador de Datos Avanzado - Moda de Lujo</title>

    <!-- Google Fonts: Poppins -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- NUEVO: Librer√≠a SheetJS para exportar a Excel -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <style>
        :root {
            --primary-color: #2c3e50; /* Un azul carb√≥n oscuro */
            --secondary-color: #f4f7f9; /* Un gris muy claro para el fondo */
            --accent-color: #d4af37; /* Dorado */
            --white-color: #ffffff;
            --text-color: #34495e;
            --light-gray: #dfe6e9;
            --shadow: 0 10px 40px rgba(0, 0, 0, 0.08);
            --border-radius: 15px;
            --excel-color: #1D6F42;
            --json-color: #F7DF1E;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--secondary-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 40px 20px;
        }

        .container {
            width: 95%;
            max-width: 1200px;
            background: var(--white-color);
            padding: 40px 50px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
            border-bottom: 1px solid var(--light-gray);
            padding-bottom: 25px;
        }

        h1 {
            font-size: 2.5rem;
            color: var(--primary-color);
            font-weight: 700;
        }

        .profile-image-container {
            cursor: pointer;
            position: relative;
        }

        .profile-image {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            border: 4px solid var(--accent-color);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            animation: heart-beat 1.5s infinite ease-in-out;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .profile-image-container:hover .profile-image {
            transform: scale(1.1);
            box-shadow: 0 0 25px var(--accent-color);
        }

        @keyframes heart-beat {
            0%, 100% { transform: scale(1); }
            10%, 30% { transform: scale(1.08); }
            20%, 40% { transform: scale(1); }
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }

        .input-group {
            position: relative;
        }

        .input-group i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #bdc3c7;
            transition: color 0.3s;
        }
        
        .input-group input:focus + i {
            color: var(--accent-color);
        }

        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--text-color);
        }

        input {
            width: 100%;
            padding: 15px 15px 15px 45px;
            border-radius: 10px;
            border: 1px solid var(--light-gray);
            font-size: 1rem;
            font-family: 'Poppins', sans-serif;
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        input:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 4px rgba(212, 175, 55, 0.15);
        }

        .export-buttons-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 40px;
        }

        .export-btn {
            color: var(--white-color);
            cursor: pointer;
            font-weight: bold;
            padding: 18px;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            transition: transform 0.2s, box-shadow 0.3s;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 12px;
        }
        
        .export-btn:hover {
            transform: translateY(-3px);
        }

        .btn-csv { background: linear-gradient(45deg, var(--primary-color), #34495e); }
        .btn-csv:hover { box-shadow: 0 8px 20px rgba(44, 62, 80, 0.3); }

        .btn-excel { background: linear-gradient(45deg, var(--excel-color), #27ae60); }
        .btn-excel:hover { box-shadow: 0 8px 20px rgba(29, 111, 66, 0.3); }

        .btn-json { background: linear-gradient(45deg, #E67E22, #F39C12); color: #2c3e50;}
        .btn-json:hover { box-shadow: 0 8px 20px rgba(243, 156, 18, 0.3); }


        .footer {
            text-align: center;
            margin-top: 40px;
            font-size: 0.9rem;
            color: #95a5a6;
        }

        /* --- Modal Styles (sin cambios) --- */
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.7); backdrop-filter: blur(5px); }
        .modal-content { position: relative; background-color: #fff; margin: 5% auto; padding: 0; width: 90%; max-width: 650px; border-radius: var(--border-radius); box-shadow: 0 5px 25px rgba(0,0,0,0.4); text-align: center; overflow: hidden; animation: zoomIn 0.5s cubic-bezier(0.165, 0.84, 0.44, 1); }
        @keyframes zoomIn { from {transform: scale(0.8); opacity: 0;} to {transform: scale(1); opacity: 1;} }
        .modal-header { background: linear-gradient(45deg, var(--primary-color), #34495e); padding: 60px 20px 80px 20px; position: relative; }
        .modal-profile-image { width: 180px; height: 180px; border-radius: 50%; border: 6px solid var(--accent-color); position: absolute; bottom: -90px; left: 50%; transform: translateX(-50%); box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .close-button { color: #fff; position: absolute; top: 15px; right: 25px; font-size: 35px; font-weight: bold; cursor: pointer; transition: transform 0.2s; }
        .close-button:hover { transform: rotate(90deg); }
        .modal-body { padding: 110px 40px 40px 40px; }
        .modal-body h2 { font-size: 2.2rem; margin-bottom: 5px; color: var(--primary-color); }
        .modal-body h3 { font-size: 1.2rem; margin-bottom: 20px; color: var(--accent-color); font-weight: 600; }
        .modal-body p { font-size: 1rem; line-height: 1.7; margin-bottom: 30px; color: #626262; }
        .services h4 { font-size: 1.1rem; color: var(--primary-color); margin-bottom: 15px; border-bottom: 2px solid var(--accent-color); display: inline-block; padding-bottom: 5px; }
        .services ul { list-style: none; padding: 0; margin-bottom: 30px; display: flex; flex-wrap: wrap; justify-content: center; gap: 12px; }
        .services li { background: var(--secondary-color); padding: 10px 20px; border-radius: 50px; font-weight: 600; color: var(--text-color); }
        .services li i { color: var(--accent-color); margin-right: 8px; }
        .social-links a { margin: 0 12px; text-decoration: none; font-size: 1.8rem; color: var(--light-gray); background-color: var(--primary-color); width: 50px; height: 50px; display: inline-flex; justify-content: center; align-items: center; border-radius: 50%; transition: transform 0.3s, background-color 0.3s; }
        .social-links a:hover { transform: translateY(-5px) scale(1.1); background-color: var(--accent-color); color: var(--white-color); }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Generador de Datos üìä</h1>
            <div class="profile-image-container" onclick="openModal()" title="Acerca de Juancito Pe√±a">
                <img src="https://avatars.githubusercontent.com/u/38921558?v=4" alt="Foto de Juancito Pe√±a" class="profile-image">
            </div>
        </header>

        <main>
            <div class="form-grid">
                <div class="input-group">
                    <label for="startDate">Fecha de Inicio</label>
                    <input type="date" id="startDate" />
                    <i class="fa-solid fa-calendar-alt"></i>
                </div>
                <div class="input-group">
                    <label for="endDate">Fecha de Fin</label>
                    <input type="date" id="endDate" />
                    <i class="fa-solid fa-calendar-alt"></i>
                </div>
                <div class="input-group">
                    <label for="recordCount">Cantidad de Registros</label>
                    <input type="number" id="recordCount" min="1" max="50000" placeholder="Ej: 5000" value="5000" />
                    <i class="fa-solid fa-hashtag"></i>
                </div>
                <div class="input-group">
                    <label for="vendors">Cantidad de Vendedores (5-25)</label>
                    <input type="number" id="vendors" min="5" max="25" placeholder="Ej: 15" value="10" />
                    <i class="fa-solid fa-users"></i>
                </div>
                <div class="input-group">
                    <label for="products">Cantidad de Productos (10-50)</label>
                    <input type="number" id="products" min="10" max="50" placeholder="Ej: 30" value="50" />
                    <i class="fa-solid fa-tags"></i>
                </div>
            </div>

            <div class="export-buttons-container">
                <button class="export-btn btn-csv" onclick="handleExport('csv')">
                    <i class="fa-solid fa-file-csv"></i> Descargar CSV
                </button>
                <button class="export-btn btn-excel" onclick="handleExport('excel')">
                    <i class="fa-solid fa-file-excel"></i> Descargar Excel
                </button>
                <button class="export-btn btn-json" onclick="handleExport('json')">
                    <i class="fa-solid fa-file-code"></i> Descargar JSON
                </button>
            </div>
        </main>

        <footer class="footer">
            <p>&copy; 2025 | Dise√±ado y desarrollado con ‚ù§Ô∏è por Juancito Pe√±a</p>
        </footer>
    </div>

    <!-- The Modal -->
    <div id="profileModal" class="modal">
        <!-- El contenido de la modal no ha cambiado -->
        <div class="modal-content">
            <div class="modal-header">
                <span class="close-button" onclick="closeModal()">&times;</span>
                <img src="https://avatars.githubusercontent.com/u/38921558?v=4" alt="Foto de Juancito Pe√±a" class="modal-profile-image">
            </div>
            <div class="modal-body">
                <h2>Juancito Pe√±a</h2>
                <h3>Desarrollador Full-Stack & UI/UX Enthusiast ‚ú®</h3>
                <p>Apasionado por crear soluciones tecnol√≥gicas eficientes y experiencias de usuario memorables que impulsan el crecimiento de los negocios en la era digital.</p>
                <div class="services">
                    <h4>Principales Servicios</h4>
                    <ul>
                        <li><i class="fa-solid fa-code"></i>Desarrollo Web a Medida</li>
                        <li><i class="fa-solid fa-database"></i>Optimizaci√≥n de Bases de Datos</li>
                        <li><i class="fa-solid fa-lightbulb"></i>Consultor√≠a Tecnol√≥gica</li>
                    </ul>
                </div>
               <div class="social-links">
  <a href="https://www.linkedin.com/in/juancitope%C3%B1a/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
  <a href="https://github.com/JUANCITOPENA" target="_blank" title="GitHub"><i class="fab fa-github"></i></a>
 <a href="https://x.com/JuancitoPenaV" target="_blank" title="X"><i class="fab fa-x-twitter"></i></a>
  <a href="https://www.facebook.com/juancito.p.v" target="_blank" title="Facebook"><i class="fab fa-facebook-f"></i></a>
  <a href="https://www.youtube.com/@JuancitoDevV" target="_blank" title="YouTube"><i class="fab fa-youtube"></i></a>
  <a href="https://www.instagram.com/juancito.pena.v/" target="_blank" title="Instagram"><i class="fab fa-instagram"></i></a>
</div>

            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Establecer valores por defecto
            document.getElementById('startDate').value = '2025-01-02';
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            document.getElementById('endDate').value = `${year}-${month}-${day}`;
            
            // Modal script
            const modal = document.getElementById("profileModal");
            window.openModal = function() { modal.style.display = "block"; }
            window.closeModal = function() { modal.style.display = "none"; }
            window.onclick = function(event) {
                if (event.target == modal) closeModal();
            }
        });

        // --- L√ìGICA DE GENERACI√ìN Y EXPORTACI√ìN ---

        function generateRawData() {
            // 1. Obtener y validar valores del formulario
            const start = document.getElementById("startDate").value;
            const end = document.getElementById("endDate").value;
            const count = parseInt(document.getElementById("recordCount").value);
            const vendorCount = parseInt(document.getElementById("vendors").value);
            const productCount = parseInt(document.getElementById("products").value);

            if (!start || !end || !count || !vendorCount || !productCount) {
                alert("Por favor, completa todos los campos para generar el archivo.");
                return null;
            }

            const startDate = new Date(start);
            const endDate = new Date(end);

            // Datos base
            const entityNames = [ "LuxuryRD", "VogueElite", "ModaPremium", "EliteFashion", "SantoDomingo Luxe", "BellaModa", "RD Golden Fashion" ];
            const categories = ["Ropa", "Calzado", "Accesorios", "Carteras", "Joyas"];
            const locations = [ "Santo Domingo", "Santiago", "La Vega", "San Crist√≥bal", "Punta Cana", "San Pedro de Macor√≠s", "B√°varo", "Puerto Plata" ];
            const realProducts = [ "Louis Vuitton Neverfull MM", "Louis Vuitton Keepall Bandouli√®re 55", "Louis Vuitton Onthego GM", "Louis Vuitton Run Away Sneaker", "Louis Vuitton Twist MM", "Louis Vuitton Brazza Wallet", "Gucci GG Marmont Matelass√©", "Gucci Ace Leather Sneakers", "Gucci Ophidia GG Medium", "Gucci Jackie 1961", "Gucci Interlocking G Bracelet", "Prada Re-Edition 2005 Nylon Bag", "Prada Cloudbust Thunder Sneakers", "Prada Saffiano Leather Wallet", "Prada Cleo Brushed Leather Bag", "Balenciaga Triple S Sneakers", "Balenciaga Hourglass Small Handbag", "Balenciaga Track Sneakers", "Dior Book Tote", "Dior Saddle Bag", "Dior B22 Sneakers", "Dior CD Icon Necklace", "Chanel Classic Flap Bag", "Chanel Boy Bag", "Chanel Coco Handle Mini", "Chanel Logo Crystal Earrings", "Fendi Baguette Bag", "Fendi Sunshine Shopper", "Fendi Peekaboo Iconic Mini", "Versace Chain Reaction Sneakers", "Versace Medusa Biggie Sunglasses", "Versace La Medusa Bag", "Burberry Lola Bag", "Burberry Cashmere Scarf", "Burberry TB Crossbody Bag", "Off-White Industrial Belt", "Off-White Out Of Office Low Sneakers", "Off-White Arrow Hoodie" ];
            const products = realProducts.slice(0, productCount);

            // 2. Generar los datos en un array de objetos
            let data = [];
            for (let i = 0; i < count; i++) {
                const randomDate = new Date(startDate.getTime() + Math.random() * (endDate.getTime() - startDate.getTime()));
                const sales = parseFloat((Math.random() * (15000 - 1500) + 1500).toFixed(2));
                const cost = parseFloat((Math.random() * (sales * 0.6 - 500) + 500).toFixed(2));
                const margin = parseFloat((sales - cost).toFixed(2));
                const expenses = parseFloat((Math.random() * (1000 - 100) + 100).toFixed(2));
                const profit = parseFloat((margin - expenses).toFixed(2));
                
                const day = String(randomDate.getDate()).padStart(2, "0");
                const month = String(randomDate.getMonth() + 1).padStart(2, "0");
                const year = randomDate.getFullYear();

                data.push({
                    "Fecha": `${day}-${month}-${year}`,
                    "Entidad": entityNames[Math.floor(Math.random() * entityNames.length)],
                    "Producto": products[Math.floor(Math.random() * products.length)],
                    "Categoria": categories[Math.floor(Math.random() * categories.length)],
                    "Ubicacion": locations[Math.floor(Math.random() * locations.length)],
                    "Ventas": sales,
                    "Costo": cost,
                    "Margen": margin,
                    "Gastos": expenses,
                    "Beneficio": profit,
                    "Margen %": `${((margin / sales) * 100).toFixed(2)}%`,
                    "Beneficio %": `${((profit / sales) * 100).toFixed(2)}%`
                });
            }
            return data;
        }

        function downloadCSV(data) {
            const headers = Object.keys(data[0]);
            const csvRows = [headers.join(',')];
            for (const row of data) {
                const values = headers.map(header => {
                    const escaped = (''+row[header]).replace(/"/g, '\\"');
                    return `"${escaped}"`;
                });
                csvRows.push(values.join(','));
            }
            const csvString = csvRows.join('\n');
            triggerDownload(csvString, 'text/csv', 'luxury_sales_data.csv');
        }

        function downloadExcel(data) {
            const worksheet = XLSX.utils.json_to_sheet(data);
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, "Datos de Ventas");
            XLSX.writeFile(workbook, "luxury_sales_data.xlsx");
        }

        function downloadJSON(data) {
            const jsonString = JSON.stringify(data, null, 2); // El 2 es para formatear con indentaci√≥n
            triggerDownload(jsonString, 'application/json', 'luxury_sales_data.json');
        }
        
        function triggerDownload(content, mimeType, fileName) {
            const blob = new Blob([content], { type: mimeType });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement("a");
            a.style.display = 'none';
            a.href = url;
            a.download = fileName;
            document.body.appendChild(a);
            a.click();
            window.URL.revokeObjectURL(url);
            document.body.removeChild(a);
        }

        // Funci√≥n principal que se llama desde los botones
        window.handleExport = function(format) {
            const data = generateRawData();
            if (!data) return; // Si la validaci√≥n falla

            switch (format) {
                case 'csv':
                    downloadCSV(data);
                    break;
                case 'excel':
                    downloadExcel(data);
                    break;
                case 'json':
                    downloadJSON(data);
                    break;
                default:
                    console.error("Formato de exportaci√≥n no soportado:", format);
            }
        }
    </script>
</body>
</html>
